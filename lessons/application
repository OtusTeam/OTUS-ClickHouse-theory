## 7. Что такое ClickHouse?
- **ClickHouse** — аналитическая колоночная система управления базами данных реального времени (column-based OLAP DBMS).

**Аналитическая (analytic):**  
Область применения:
- Годовые/квартальные/месячные отчеты.
- Выявление закономерностей.
- Изучение аудитории и таргетинг.
- Обучение ML-моделей.
- Хранение метрик и логов.

**Колоночная (column-based):**  
Особенности:
- Данные хранятся столбцами, не строками.
- Эффективное хранение и выборка отдельных столбцов.
- Широкие таблицы.
- Нормализация — зло.
- Удаление/изменение данных — дорого.

**Система управления базами данных (СУБД/DBMS):**  
- Создание и управление несколькими БД.
- Можно говорить «база данных», вас поймут.
- Практически все БД в настоящее время являются СУБД.

**Реального времени (online):**  
- Лучше говорить online.
- Данные запрашиваются, готовятся и выводятся за один запрос.
- Достаточное время ответа для интеграции на сайт.

---

## 8. Возможности ClickHouse
- Горизонтальное масштабирование.
- Многоуровневое хранение.
- Высокая пропускная способность.
- Приближенные вычисления.
- Интеграция с другими системами.
- Преобразование данных.

**Горизонтальное масштабирование:**
- Поддерживается добавление/удаление шардов и реплик.
- Кластер — топология, описанная в конфигурации.
- Можно описать несколько топологий.
- Сервер может быть частью нескольких кластеров.

**Многоуровневое хранение:**
- Можно описать несколько `storage_policy`.
- `storage_policy` состоит из набора сущностей `volume`.
- `volume` состоит из набора сущностей `disk`.
- Можно назначить `storage_policy` на таблицу.
- Volume имеют приоритет: данные перемещаются на нижестоящие по мере заполнения вышестоящих.
- Поддерживаются облачные диски: s3 / gcs / azure / hdfs / readonly web.

**Высокая пропускная способность:**
- Колоночное хранение обеспечивает высокую степень сжатия любыми кодеками.
- На простых запросах достигается выдача данных на скорости дисковой системы, умноженной на уровень сжатия.
- Низкая производительность на множестве точечных запросов.

**Приближенные вычисления:**
- Функции: `uniq`, квантили, медианы, линейная/стохастическая регрессия.
- Особенности: семплинг, группировка по первым N ключам.

**Интеграция с другими системами:**
- Облачные файловые системы: s3 / gcs / azure / hdfs.
- Базы данных: postgresql / mysql / mongo / rocksdb / redis.
- Брокеры сообщений: rabbitmq / kafka / NATS.
- Hive / iceberg / hudi / deltalake / sqlite.
- Инструменты: redash / grafana / tableau / superset / vector.
- Официальные библиотеки для python / golang / java / C++, а также неофициальные для многих других.

**Преобразования данных:**
- Материализованные представления (MV): механизм для преобразования данных, реализован как преобразование данных, поступающих в INSERT, со складыванием в другую таблицу.
- Проекции: альтернативная реализация MV, сохраняющая данные в саму таблицу для представления с иным ключом.
- Таблицы, поддерживающие фоновую агрегацию данных: удаление дубликатов, суммирование по primary ключу, более сложная логика на функциях агрегации.
- EXTRACT, TRANSFORM, LOAD.

---

## 9. Терминология
- **ENGINE:** Подвид базы данных или таблицы, отличающийся в реализации, применимых запросах, назначении. Бывают семейства MergeTree и специальные.  
  Пример: `TABLE Engine=ReplacingMergeTree` удаляет дубликаты по основному ключу; `TABLE Engine=Kafka` — специальный Engine для интеграции с Kafka.

- **MergeTree:** Основной ENGINE, одноименный с алгоритмом, сердце ClickHouse. Применяется чаще всего, на нём основана большая часть ENGINE, а именно MergeTree family.

- **PART и PARTITION:**
  - **PART** — набор данных, создаваемый в результате INSERT. Хранятся каталогами на файловой системе. Внутри каталога: файл данных, файл засечек на каждый столбец, файл с primary-индексом, контрольные суммы и метаданные колонок.
  - **PARTITION** — набор PART-ов, принадлежащих одному значению PARTITION BY ключа, подлежащих объединению фоновыми операциями Merge.

- **Слияние / merge:** Фоновая операция по объединению данных нескольких PART-ов в новый PART.

- **Ключи сортировки и семплинга:**  
  Кроме PRIMARY KEY и PARTITION KEY, есть:
  - `ORDER BY KEY` — ключ, по которому сортируются данные в PART.
  - `SAMPLE BY KEY` — ключ для семплирования.

- **Разреженный индекс:**  
  Данные в колонках хранятся гранулами (по `index_granularity` строк на гранулу, по умолчанию 8123). Данные отсортированы по PRIMARY KEY. Индексируются min и max значения гранул, а не каждое значение.

- **Теневые копии / shadow:** Артефакт резервного копирования. Набор PART-ов вне data-каталога ClickHouse, содержащий hardlink-и.

---

## 10. Сообщество
- **Чат / Telegram:** https://t.me/clickhouse_ru — официальный чат ClickHouse, самое популярное и активное место для получения поддержки и ответа на вопросы.
- **Документация:** https://clickhouse.com/docs — место, в которое отправляют в чате, когда не хотят отвечать на простые вопросы.
- **GitHub:** https://github.com/ClickHouse/ClickHouse — код ClickHouse, а также issue-трекер с актуальными проблемами.

---

**Вопросы для самопроверки:**
1. К каким классам систем относится ClickHouse?
2. Какую проблемы вы бы решили, используя ClickHouse, а какую не стали бы им решать?
3. Где можно получить помощь по ClickHouse и куда сообщать о багах?
